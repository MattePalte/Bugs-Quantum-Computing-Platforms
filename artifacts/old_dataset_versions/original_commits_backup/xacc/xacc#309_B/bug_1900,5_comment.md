In the kak decomposition code there is a rotation gate applied to bit 2 (wrong) instead of bit 1 (correct).